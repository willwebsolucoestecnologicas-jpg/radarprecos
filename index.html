<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kalango - O Fiscal de Pre√ßos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #0f172a; color: #e2e8f0; -webkit-tap-highlight-color: transparent; }
        .glass-panel { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.05); }
        .nav-btn { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; padding: 12px 0; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); position: relative; }
        .nav-btn i { font-size: 1.25rem; margin-bottom: 4px; transition: transform 0.2s; }
        .nav-btn span { font-size: 0.65rem; font-weight: 600; letter-spacing: 0.5px; }
        .nav-btn:active i { transform: scale(0.9); }
        
        /* Efeito de brilho verde no bot√£o ativo */
        .nav-btn.text-emerald-500::after {
            content: ''; position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            width: 40px; height: 2px; background: #10b981; box-shadow: 0 0 10px #10b981; border-radius: 0 0 4px 4px;
        }

        .loader { border: 2px solid #f3f3f3; border-top: 2px solid #10b981; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* Personaliza√ß√£o do Chat Kalango */
        .chat-user { align-self: flex-end; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border-radius: 18px 18px 2px 18px; padding: 12px 16px; max-width: 85%; box-shadow: 0 4px 15px rgba(16, 185, 129, 0.2); }
        .chat-ai { align-self: flex-start; background: #1e293b; border: 1px solid #334155; color: #cbd5e1; border-radius: 18px 18px 18px 2px; padding: 12px 16px; max-width: 85%; }
        
        /* Scrollbar fina */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden selection:bg-emerald-500 selection:text-white">

    <div id="toast-notification" class="fixed top-6 left-1/2 transform -translate-x-1/2 bg-emerald-600 text-white px-6 py-4 rounded-2xl shadow-2xl z-[100] flex items-center gap-3 font-bold transition-all duration-500 -translate-y-32 opacity-0 w-max max-w-[90%] border border-white/10">
        <i id="toast-icon" class="fas fa-circle-check text-xl"></i>
        <span id="toast-message" class="text-sm">Notifica√ß√£o</span>
    </div>

    <header class="pt-12 pb-4 px-6 bg-gradient-to-b from-slate-900 to-slate-900/0 z-20 flex justify-between items-center sticky top-0">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-emerald-500/10 rounded-xl flex items-center justify-center border border-emerald-500/20 shadow-[0_0_15px_rgba(16,185,129,0.15)]">
                <span class="text-2xl">ü¶é</span>
            </div>
            <div>
                <h1 class="text-xl font-black tracking-tighter text-white">KALANGO</h1>
                <p class="text-[10px] font-bold text-emerald-500 tracking-widest uppercase">Lu√≠s Gomes ‚Ä¢ RN</p>
            </div>
        </div>
        <div class="bg-slate-800/50 px-3 py-1 rounded-full border border-slate-700 backdrop-blur-sm">
            <span class="text-[10px] font-mono text-slate-400">v8.1</span>
        </div>
    </header>

    <main class="flex-1 overflow-y-auto px-4 pb-24 relative scroll-smooth" id="main-content">
        
        <div id="registrar-container" class="animate-fade-in">
            <div class="bg-gradient-to-br from-slate-800 to-slate-900 rounded-3xl p-1 shadow-2xl border border-slate-700/50 mb-6 relative overflow-hidden group">
                <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-emerald-500 via-lime-400 to-emerald-500 opacity-50 group-hover:opacity-100 transition-opacity"></div>
                
                <div id="scanner-section" class="p-6 text-center">
                    <div class="w-16 h-16 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-4 text-emerald-400">
                        <i class="fas fa-barcode text-2xl"></i>
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2">Ler C√≥digo de Barras</h2>
                    <p class="text-xs text-slate-400 mb-6 px-4">Aponte para o c√≥digo do produto para registrar ou consultar o pre√ßo.</p>
                    
                    <div id="reader" class="rounded-xl overflow-hidden mb-4 border-2 border-dashed border-slate-600 bg-black min-h-[200px] relative"></div>
                    <div id="scan-message" class="text-emerald-400 text-sm font-bold animate-pulse hidden mb-4">Lendo c√¢mera...</div>

                    <button id="start-scan-btn" class="w-full bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-4 rounded-xl shadow-lg shadow-emerald-900/20 active:scale-95 transition-all flex items-center justify-center gap-2 text-sm uppercase tracking-wide">
                        <i class="fas fa-camera"></i> Abrir C√¢mera
                    </button>
                    
                    <div class="mt-4 pt-4 border-t border-slate-700/50">
                         <button id="btn-scan-pesquisa" class="text-xs text-slate-400 hover:text-white flex items-center justify-center gap-2 mx-auto py-2">
                            <i class="fas fa-search"></i> Ou clique aqui para apenas pesquisar
                        </button>
                    </div>
                </div>

                <div id="price-form-section" class="hidden p-5">
                    <div class="flex items-center gap-3 mb-6 pb-4 border-b border-slate-700/50">
                        <button onclick="location.reload()" class="w-8 h-8 rounded-full bg-slate-700 hover:bg-slate-600 flex items-center justify-center text-white transition-colors">
                            <i class="fas fa-arrow-left text-xs"></i>
                        </button>
                        <h3 class="font-bold text-white">Novo Pre√ßo</h3>
                    </div>

                    <form id="price-form" class="space-y-4">
                        <input type="hidden" id="ean-field">
                        <input type="hidden" id="image-url-field">

                        <div class="flex gap-3">
                            <div class="w-20 h-20 bg-slate-900 rounded-xl border border-slate-700 flex items-center justify-center overflow-hidden relative group cursor-pointer flex-shrink-0" id="btn-camera-foto">
                                <div class="text-center">
                                    <i class="fas fa-camera text-slate-500 text-xl mb-1"></i>
                                    <span class="block text-[8px] text-slate-500 font-bold uppercase">Foto</span>
                                </div>
                            </div>
                            <input type="file" id="input-foto-produto" accept="image/*" capture="environment" class="hidden">
                            <img id="preview-imagem" class="w-20 h-20 rounded-xl object-cover border border-emerald-500 hidden bg-black">
                            
                            <div class="flex-1">
                                <label class="block text-[10px] font-bold text-emerald-500 uppercase mb-1">Produto</label>
                                <input type="text" id="product-name" class="w-full bg-slate-900 border border-slate-700 text-white text-sm rounded-xl px-4 py-3 focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 outline-none transition-all font-medium" placeholder="Ex: Arroz Tio Jo√£o" required>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-[10px] font-bold text-slate-400 uppercase mb-1">Pre√ßo (R$)</label>
                                <div class="relative">
                                    <span class="absolute left-4 top-1/2 -translate-y-1/2 text-slate-500 font-bold text-sm">R$</span>
                                    <input type="number" id="price" step="0.01" class="w-full bg-slate-900 border border-slate-700 text-white text-lg font-bold rounded-xl pl-10 pr-4 py-3 focus:border-emerald-500 outline-none" placeholder="0,00" required>
                                </div>
                            </div>
                            <div>
                                <label class="block text-[10px] font-bold text-slate-400 uppercase mb-1">Mercado</label>
                                <select id="market" class="w-full bg-slate-900 border border-slate-700 text-white text-sm rounded-xl px-4 py-3 focus:border-emerald-500 outline-none appearance-none">
                                    <option>Carregando...</option>
                                </select>
                            </div>
                        </div>

                        <div>
                            <label class="block text-[10px] font-bold text-slate-400 uppercase mb-1">Seu Nome (Opcional)</label>
                            <input type="text" id="username" class="w-full bg-slate-900 border border-slate-700 text-slate-300 text-sm rounded-xl px-4 py-3 focus:border-emerald-500 outline-none" placeholder="Quem est√° enviando?">
                        </div>

                        <button type="submit" class="w-full bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-4 rounded-xl shadow-lg shadow-emerald-900/20 active:scale-95 transition-all mt-4 text-sm uppercase tracking-wide">
                            <i class="fas fa-check-circle mr-2"></i> Salvar Pre√ßo
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <div id="consultar-container" class="hidden animate-fade-in">
            <div class="sticky top-0 bg-[#0f172a] z-10 pb-4 pt-2">
                <div class="flex gap-2">
                    <div class="relative flex-1">
                        <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-slate-500"></i>
                        <input type="text" id="ean-busca" class="w-full bg-slate-800 border border-slate-700 text-white rounded-xl pl-10 pr-12 py-3 focus:border-emerald-500 outline-none shadow-lg" placeholder="Digite o c√≥digo de barras...">
                        <button class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-white p-1" onclick="document.getElementById('ean-busca').value = ''"><i class="fas fa-times"></i></button>
                    </div>
                    <button id="btn-pesquisar" class="bg-emerald-600 hover:bg-emerald-500 text-white w-12 rounded-xl flex items-center justify-center shadow-lg transition-colors">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
            
            <div id="resultados-consulta" class="pb-10">
                <div class="text-center py-10 opacity-30">
                    <i class="fas fa-search text-4xl mb-3"></i>
                    <p>Digite um c√≥digo ou use o scanner</p>
                </div>
            </div>
        </div>

        <div id="catalogo-container" class="hidden animate-fade-in">
            <div class="mb-4 flex justify-between items-center">
                <h2 class="text-lg font-bold text-white">Cat√°logo</h2>
                <div class="bg-emerald-500/10 px-3 py-1 rounded-full border border-emerald-500/20">
                   <span class="text-[10px] text-emerald-400 font-bold uppercase">Lu√≠s Gomes</span>
                </div>
            </div>
            
            <div class="mb-4 overflow-x-auto pb-2 scrollbar-hide">
                 <select id="filtro-mercado-catalogo" class="bg-slate-800 text-white text-xs px-4 py-2 rounded-lg border border-slate-700 outline-none w-full">
                    <option value="todos">Todos os Mercados</option>
                 </select>
            </div>

            <div id="lista-catalogo" class="grid grid-cols-1 gap-3">
                </div>
        </div>

        <div id="chat-container" class="hidden flex flex-col h-[calc(100vh-180px)]">
            <div class="text-center mb-4">
                <h2 class="text-lg font-black text-white flex items-center justify-center gap-2">
                    <span class="text-emerald-500 text-xl">ü¶é</span> Kalango
                    <span class="bg-emerald-600 text-white text-[9px] px-1.5 py-0.5 rounded font-bold uppercase tracking-wide">AI</span>
                </h2>
                <p class="text-[10px] text-slate-400">Pergunte sobre os pre√ßos</p>
            </div>

            <div id="chat-messages" class="flex-1 overflow-y-auto space-y-3 p-2 bg-slate-900/50 rounded-2xl border border-slate-800 mb-3">
                </div>

            <div class="flex gap-2 relative">
                <input type="text" id="chat-input" class="w-full bg-slate-800 border border-slate-700 text-white rounded-xl pl-4 pr-12 py-3 focus:border-emerald-500 outline-none shadow-lg text-sm" placeholder="Ex: Onde tem a√ß√∫car barato?">
                <button id="btn-enviar-chat" class="absolute right-2 top-1/2 -translate-y-1/2 bg-emerald-600 hover:bg-emerald-500 text-white w-8 h-8 rounded-lg flex items-center justify-center shadow-lg transition-transform active:scale-90">
                    <i class="fas fa-paper-plane text-xs"></i>
                </button>
            </div>
        </div>

    </main>

    <nav class="fixed bottom-0 w-full bg-[#0f172a] border-t border-slate-800 pb-safe pt-1 px-2 z-50 flex justify-around items-end h-[80px]">
        <button id="nav-registrar" class="nav-btn text-emerald-500" onclick="trocarAba('registrar')">
            <i class="fas fa-plus-circle"></i>
            <span>Registrar</span>
        </button>
        <button id="nav-consultar" class="nav-btn text-slate-500 hover:text-emerald-400" onclick="trocarAba('consultar')">
            <i class="fas fa-search"></i>
            <span>Buscar</span>
        </button>
        <button id="nav-catalogo" class="nav-btn text-slate-500 hover:text-emerald-400" onclick="trocarAba('catalogo')">
            <i class="fas fa-list-ul"></i>
            <span>Cat√°logo</span>
        </button>
        <button id="nav-chat" class="nav-btn text-slate-500 hover:text-emerald-400" onclick="trocarAba('chat')">
            <i class="fas fa-robot"></i>
            <span>Kalango</span>
        </button>
    </nav>

    <script src="script.js"></script>
</body>
</html>
